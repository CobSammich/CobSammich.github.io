<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="date" content="2022-03-07" scheme="YYYY-MM-DD">
        <meta name="viewport" content="width=device-width" />
        <title>5-2</title>
        <link rel="stylesheet" href="../../style.css" type="text/css"
         media="screen" title="no title" charset="utf-8">
        <link rel="stylesheet" href="../../pygmentize.css" type="text/css"
         media="screen" title="no title" charset="utf-8">
        <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/default.min.css" />
    </head>
    <body>
        <script>
            MathJax = {
              tex: {
                inlineMath: [['$', '$'], ['$$', '$$']]
              },
              svg: {
                fontCache: 'global'
              }
            };
        </script>
        <script type="text/javascript" src="/home/cob/git_repos/MathJax/es5/tex-chtml.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
        <script type="text/javascript">
            document.querySelectorAll('pre').forEach(block => hljs.highlightBlock(block));
        </script>
        <p><a href="index.html">Return to Chapter 5 Index</a></p>
<h1>An Example Program Using Structs</h1>
<p>The code below is of a simple program that computes the area of a rectangle.</p>
<div class="codehilite"><pre><span></span><code><span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">width1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">height1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;The area of the rectangle is {} square pixels.&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">area</span><span class="p">(</span><span class="n">width1</span><span class="p">,</span><span class="w"> </span><span class="n">height1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">area</span><span class="p">(</span><span class="n">width</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"> </span><span class="n">height</span>: <span class="kt">u32</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>The program above assumes that width and height are related. This is not necessarily intuitive,
therefore it may be better to use a different approach.</p>
<p>Using Structs here is more intuitive for the person writing the program. Below is an example of how
this would be written.</p>
<div class="codehilite"><pre><span></span><code><span class="k">struct</span> <span class="nc">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">width</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">height</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">rect1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">width</span>: <span class="mi">30</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">height</span>: <span class="mi">50</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="w"></span>
<span class="w">        </span><span class="s">&quot;The area of the rectangle is {} square pixels.&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">area</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rect1</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">area</span><span class="p">(</span><span class="n">rectangle</span>: <span class="kp">&amp;</span><span class="nc">Rectangle</span><span class="p">)</span><span class="w"> </span>-&gt; <span class="kt">u32</span> <span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">rectangle</span><span class="p">.</span><span class="n">width</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">rectangle</span><span class="p">.</span><span class="n">height</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<h2>Adding Useful Functionality with Derived Traits</h2>
<p>If we try to print the information in <code>rect1</code> via <code>println!("rect1 is {}", rect1);</code> we get the
following error:</p>
<div class="codehilite"><pre><span></span><code><span class="sb">`</span>std::fmt::Display<span class="sb">`</span> is not implemented <span class="k">for</span> <span class="sb">`</span>Rectangle<span class="sb">`</span>.
</code></pre></div>

<p><code>Display</code> is a function implemented by many of the primitive types and explains a way to print
things to the console. For primitive types, it is pretty straight forward what you want printed, but
for structs it may not be.</p>
<p>To get structs to print to the console how a primitive type might, we have to do 2 things:
1. Put <code>{:?}</code> inside of <code>println!</code> instead of just <code>{}</code>.
2. Add the debug attritute to the line above our struct declaration: <code>#[derive(Debug)]</code></p>
<div class="codehilite"><pre><span></span><code><span class="cp">#[derive(Debug)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">width</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">height</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">rect1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">width</span>: <span class="mi">30</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="n">height</span>: <span class="mi">50</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="fm">println!</span><span class="p">(</span><span class="s">&quot;rect1 is {:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">rect1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>The output it produces is not the best looking. To change it such that each of the structs fields
prints on different lines, use <code>{:#?}</code> instead.</p>
<p>You can also print out a value using the <code>dbg!</code> macro. The <code>dbg!</code> macro takes ownership of an
expression, prints the file and the line number, and returns ownership of that value. Calling <code>dbg!</code>
prints to <code>stderr</code> stream instead of the <code>stdout</code> stream.</p>
<p>You can even call the <code>dbg!</code> macro inside a variable declaration. The code snippet below shows the
<code>dbg!</code> macro in use on variable assignment for width:</p>
<div class="codehilite"><pre><span></span><code><span class="cp">#[derive(Debug)]</span><span class="w"></span>
<span class="k">struct</span> <span class="nc">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">width</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">height</span>: <span class="kt">u32</span><span class="p">,</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">rect1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Rectangle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="n">width</span>: <span class="nc">dbg</span><span class="o">!</span><span class="p">(</span><span class="mi">30</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">scale</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="n">height</span>: <span class="mi">50</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">};</span><span class="w"></span>

<span class="w">    </span><span class="fm">dbg!</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rect1</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>In the next section, we will talk about how we would turn the <code>area</code> function into an <code>area</code>
<em>method</em> defined for our <code>Rectangle</code> type.</p>
<p><a href="5-3.html">Next Section</a></p>
    </body>
</html>


